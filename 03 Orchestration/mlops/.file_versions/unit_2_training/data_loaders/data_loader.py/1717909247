import pandas as pd
from typing import List

if 'data_loader' not in globals():
    from mage_ai.data_preparation.decorators import data_loader


@data_loader
def ingest_files(**kwargs) -> pd.DataFrame:
    dfs: List[pd.DataFrame] = []

    # Assuming the files are named yellow_tripdata_2024-01.parquet, yellow_tripdata_2024-02.parquet, etc.
    for year, months in [(2023, (1, 3))]:
        for i in range(*months):
            file_path = f"mlops/Home/data/yellow_tripdata_{year}-{i:02d}.parquet"
            df = pd.read_parquet(file_path)
            dfs.append(df)

    return pd.concat(dfs)
